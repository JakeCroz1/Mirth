<transformer version="4.5.0">
  <elements>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Message code</name>
      <sequenceNumber>0</sequenceNumber>
      <enabled>true</enabled>
      <variable>Message code</variable>
      <mapping>msg[&apos;MSH&apos;][&apos;MSH.9&apos;][&apos;MSH.9.1&apos;].toString().trim()+&quot; &quot;+ msg[&apos;MSH&apos;][&apos;MSH.9&apos;][&apos;MSH.9.2&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient ID</name>
      <sequenceNumber>1</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient ID</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.1&apos;][&apos;PID.1.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient last name</name>
      <sequenceNumber>2</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient last name</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient first name</name>
      <sequenceNumber>3</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient first name</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.2&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient Date Of Birth</name>
      <sequenceNumber>4</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient Date Of Birth</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.7&apos;][&apos;PID.7.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient sex</name>
      <sequenceNumber>5</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient sex</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.8&apos;][&apos;PID.8.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Patient Address</name>
      <sequenceNumber>6</sequenceNumber>
      <enabled>true</enabled>
      <variable>Patient Address</variable>
      <mapping>msg[&apos;PID&apos;][&apos;PID.11&apos;][&apos;PID.11.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.javascriptstep.JavaScriptStep version="4.5.0">
      <name>Conversion</name>
      <sequenceNumber>7</sequenceNumber>
      <enabled>true</enabled>
      <script>var hl7JsonObject = {
	first_name: msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.2&apos;].toString(),
	last_name: msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.1&apos;].toString(),
	date_of_birth: moment(msg[&apos;PID&apos;][&apos;PID.7&apos;][&apos;PID.7.1&apos;].toString(),&quot;YYYYMMDD&quot;).format(&quot;YYYY-MM-DD&quot;) //yyyymmdd to yyyy-mm-dd
	};
channelMap.put(&apos;hl7_json_object&apos;, hl7JsonObject);</script>
    </com.mirth.connect.plugins.javascriptstep.JavaScriptStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Sending Facility</name>
      <sequenceNumber>8</sequenceNumber>
      <enabled>true</enabled>
      <variable>Sending Facility</variable>
      <mapping>msg[&apos;MSH&apos;][&apos;MSH.4&apos;][&apos;MSH.4.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Recieving Facility</name>
      <sequenceNumber>9</sequenceNumber>
      <enabled>true</enabled>
      <variable>Recieving Facility</variable>
      <mapping>msg[&apos;MSH&apos;][&apos;MSH.6&apos;][&apos;MSH.6.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>Sending Application</name>
      <sequenceNumber>10</sequenceNumber>
      <enabled>true</enabled>
      <variable>Sending Application</variable>
      <mapping>msg[&apos;MSH&apos;][&apos;MSH.3&apos;][&apos;MSH.3.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.mapper.MapperStep version="4.5.0">
      <name>DateTimeOfMessage</name>
      <sequenceNumber>11</sequenceNumber>
      <enabled>true</enabled>
      <variable>DateTimeOfMessage</variable>
      <mapping>msg[&apos;MSH&apos;][&apos;MSH.7&apos;][&apos;MSH.7.1&apos;].toString().trim()</mapping>
      <defaultValue></defaultValue>
      <replacements/>
      <scope>CHANNEL</scope>
    </com.mirth.connect.plugins.mapper.MapperStep>
    <com.mirth.connect.plugins.javascriptstep.JavaScriptStep version="4.5.0">
      <name>DateTimeConversion</name>
      <sequenceNumber>12</sequenceNumber>
      <enabled>true</enabled>
      <script>var hl7HeaderJsonObject = {
	date_time_message: moment(msg[&apos;MSH&apos;][&apos;MSH.7&apos;][&apos;MSH.7.1&apos;].toString(),&quot;YYYYMMDDHHmmss&quot;).format(&quot;MMMM D, YYYY hh:mm A&quot;) //yyyymmdd to yyyy-mm-dd
	};
channelMap.put(&apos;hl7HeaderJsonObject&apos;, hl7HeaderJsonObject);</script>
    </com.mirth.connect.plugins.javascriptstep.JavaScriptStep>
  </elements>
  <inboundTemplate encoding="base64">TVNIfF5+XCZ8TnRpZXJwcmlzZXxOdGllcnByaXNlIENsaW5pY3xIZWFsdGhtYXRpY3MgRUhSfEhlYWx0aG1hdGljcyBDbGluaWN8MjAxOTA0MjMxMTM5MTB8fEFEVF5BMDh8ODg5OS0zOXxQfDIuM3x8fE5FfE5FCkVWTnxBMDh8MjAxOTA0MjMxMTM5MTB8fDAxClBJRHwxfHwxNTF8fEJvbmReVGlueXx8MTk5OTA3MjN8TXx8fDgzODggU2VjcmV0IEFnZW50IFdheV5eUmFsZWlnaF5OQ14yNzY3N3x8fHx8fHwxNTF8fHx8fHx8fHx8fHxOCk5LMXwxfEJvbmReTGFkeV5UfFNwb3VzZV5TcG91c2V8MDA3IFNvaG8gTGFuZV5eQ2FyeV5OQ14yNzUxMXwoOTE5KTAwNy0wMDA3Xl5QSF5eXjkxOV4wMDcwMDA3ClBWMXwxfFJ8fHx8fE1hbm5pbmdeTWFubmluZ15UZXJyeV5eXl5eXiY3NjU0MzIxJlVQSU58fHx8fHx8fHxOfHxBCkdUMXwxfDE1MHxCb25kXkphbWVzXl4wMDd8fDAwNyBTb2hvIExhbmVeXkNhcnleTkNeMjc1MTF8KDkxOSkwMDctMDAwN15eUEheXl45MTleMDA3MDAwN34oNzc3KTcwNy0wNzA3Xl5DUF5eXjc3N143MDcwNzA3fl5ORVReWC40MDBeMDA3QEJyaXRpc2hTZWNyZXRTZXJ2aWNlLmNvbXwoOTE5KTg1MS02MTc3IFgwMDdeXl5eXjkxOV44NTE2MTc3XjAwN3wxOTc3MDkyMHxNfHx8MDA3LTAwLTAwMDd8fHx8fDI5ODggRW5nbGFuZCBEcml2ZV5eTG9uZG9uXkRDfHx8Rnx8fHx8fHx8fHxNfHx8fHx8fHx8fHx8fHx8fHx8fHx8QnJpdGlzaCBTZWNyZXQgU2VydmljZQ==</inboundTemplate>
  <outboundTemplate encoding="base64"></outboundTemplate>
  <inboundDataType>HL7V2</inboundDataType>
  <outboundDataType>HL7V2</outboundDataType>
  <inboundProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2DataTypeProperties" version="4.5.0">
    <serializationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2SerializationProperties" version="4.5.0">
      <handleRepetitions>true</handleRepetitions>
      <handleSubcomponents>true</handleSubcomponents>
      <useStrictParser>false</useStrictParser>
      <useStrictValidation>false</useStrictValidation>
      <stripNamespaces>false</stripNamespaces>
      <segmentDelimiter>\r</segmentDelimiter>
      <convertLineBreaks>true</convertLineBreaks>
    </serializationProperties>
    <deserializationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2DeserializationProperties" version="4.5.0">
      <useStrictParser>false</useStrictParser>
      <useStrictValidation>false</useStrictValidation>
      <segmentDelimiter>\r</segmentDelimiter>
    </deserializationProperties>
    <batchProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2BatchProperties" version="4.5.0">
      <splitType>MSH_Segment</splitType>
      <batchScript></batchScript>
    </batchProperties>
    <responseGenerationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2ResponseGenerationProperties" version="4.5.0">
      <segmentDelimiter>\r</segmentDelimiter>
      <successfulACKCode>AA</successfulACKCode>
      <successfulACKMessage></successfulACKMessage>
      <errorACKCode>AE</errorACKCode>
      <errorACKMessage>An Error Occurred Processing Message.</errorACKMessage>
      <rejectedACKCode>AR</rejectedACKCode>
      <rejectedACKMessage>Message Rejected.</rejectedACKMessage>
      <msh15ACKAccept>false</msh15ACKAccept>
      <dateFormat>yyyyMMddHHmmss.SSS</dateFormat>
    </responseGenerationProperties>
    <responseValidationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2ResponseValidationProperties" version="4.5.0">
      <successfulACKCode>AA,CA</successfulACKCode>
      <errorACKCode>AE,CE</errorACKCode>
      <rejectedACKCode>AR,CR</rejectedACKCode>
      <validateMessageControlId>true</validateMessageControlId>
      <originalMessageControlId>Destination_Encoded</originalMessageControlId>
      <originalIdMapVariable></originalIdMapVariable>
    </responseValidationProperties>
  </inboundProperties>
  <outboundProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2DataTypeProperties" version="4.5.0">
    <serializationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2SerializationProperties" version="4.5.0">
      <handleRepetitions>true</handleRepetitions>
      <handleSubcomponents>true</handleSubcomponents>
      <useStrictParser>false</useStrictParser>
      <useStrictValidation>false</useStrictValidation>
      <stripNamespaces>false</stripNamespaces>
      <segmentDelimiter>\r</segmentDelimiter>
      <convertLineBreaks>true</convertLineBreaks>
    </serializationProperties>
    <deserializationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2DeserializationProperties" version="4.5.0">
      <useStrictParser>false</useStrictParser>
      <useStrictValidation>false</useStrictValidation>
      <segmentDelimiter>\r</segmentDelimiter>
    </deserializationProperties>
    <batchProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2BatchProperties" version="4.5.0">
      <splitType>MSH_Segment</splitType>
      <batchScript></batchScript>
    </batchProperties>
    <responseGenerationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2ResponseGenerationProperties" version="4.5.0">
      <segmentDelimiter>\r</segmentDelimiter>
      <successfulACKCode>AA</successfulACKCode>
      <successfulACKMessage></successfulACKMessage>
      <errorACKCode>AE</errorACKCode>
      <errorACKMessage>An Error Occurred Processing Message.</errorACKMessage>
      <rejectedACKCode>AR</rejectedACKCode>
      <rejectedACKMessage>Message Rejected.</rejectedACKMessage>
      <msh15ACKAccept>false</msh15ACKAccept>
      <dateFormat>yyyyMMddHHmmss.SSS</dateFormat>
    </responseGenerationProperties>
    <responseValidationProperties class="com.mirth.connect.plugins.datatypes.hl7v2.HL7v2ResponseValidationProperties" version="4.5.0">
      <successfulACKCode>AA,CA</successfulACKCode>
      <errorACKCode>AE,CE</errorACKCode>
      <rejectedACKCode>AR,CR</rejectedACKCode>
      <validateMessageControlId>true</validateMessageControlId>
      <originalMessageControlId>Destination_Encoded</originalMessageControlId>
      <originalIdMapVariable></originalIdMapVariable>
    </responseValidationProperties>
  </outboundProperties>
</transformer>